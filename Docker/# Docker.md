# Docker

Run your application always inside the same environment.

The difference between virtual machine and docker is that the apps in docker shares the kernel that docker provides, which unluckily shares some functionalities with the host (that's why mac-m1 sometimes doesn't work with some python package that works in ubuntu) while virtual machines install everything inside the host.

Docker run a container from an image. To run a container we need an image.

# Image

The image is conformed by
- Has the Operative system (not the kernel).
- Has our software and tis dependencies.

Image are generated by Dockerfile

Docker build to generate the image from our dockerfile and docker run for run it in a container.

The image can be created by us or by other person.

## Run Image

``` bash
docker run postgress
```
If the image is not found local, it's going to look it in the docker hub.

You can download the image without executing it with
``` bash
docker pull postgress
```

We can add a tag at the end, where it differenciate different versions, default is `latest`

``` bash
docker run postgress:version
```

Sometimes it will ask you to run with environment variables like this

``` bash
docker run -e PASSWORD=password postgress:version
```

Each image is a set of layers, so when you download it, it will download every layer asociated with different hashes. This allow you to download only the layers that you don't have in your machine.

## Other useful commands

Shows all your images
``` bash
docker images # | head -> for just show some of them 
```

Show which containers are running

``` bash
docker ps
```

Show all containers running and not running

``` bash
docker ps -a
```

Run containers that are stopped, all the data will be again alive. But the idea of the containers is not to save data in the container.

``` bash
docker start <container id>
```

Show the logs of a ontainer

``` bash
docker log <container id> # We can also specify by name instead of container ID. 
```

If you want to follow the log and keep showing you

``` bash
docker log -f <container id>
```

NEVER send the logs in a file inside the docker container, because docker captures the stdout of the app and can show it to you.

Execute a command inside a docker that is running

``` bash
docker exec -it <container id> sh # i creates an interactive session and t it's going to emulate a terminal, and we can execute sh which is a shell so we can execute other commands in the shell.
```

Stop the container

``` bash
docker stop <container id>
```

Run container in background mode

``` bash
docker run -d <container id> # where d means detach.
```